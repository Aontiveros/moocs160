<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name ="viewport" content ="width =device-width, initial-scale =1">
  <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css" />
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="main.css">
  <title>manooc</title>
</head>
<body>
  <script type="text/javascript">
  var xml = new XMLHttpRequest()

  $(document).ready(function () {
    //sidebar toggle
    $('.sidebar-btn').click(function(){
      $('#wrapper').toggleClass('toggled');
    });

    //
    //Ajax get request
    //
    $('#search-btn').click(function(){
      //console.log("---------get allCourseData-----------");
      var reg = /[^A-Za-z0-9 ]/;

      if(!reg.test($("#searchBarTextBox").value)){
        xml.open("GET", "/allCourseData", true);
        xml.send();
      }else{
        alert("Please use only letters and digits in your search.");
      }
    });

    //
    //Ajax response
    //
    xml.onreadystatechange = function() {
      if (xml.readyState == 4) {
        var xmldata = jQuery.parseJSON(xml.responseText);
        //window.alert(JSON.stringify(xmldata));
        //document.write(JSON.stringify(xmldata));
        addToCourseTable(xmldata);
        xmlhttp.send(null);
      }
    }

    //
    //ajax data parsed to table rows
    //
    function addToCourseTable(data){
      var content;
      jQuery.each(data, function(i, val) {
        //console.log(i +" ------  "+ val.title );
        content +=
        "<tr id=\"searchResRow\">"+
        "<td><img class=\"img-circle\" src=\""+val.course_image + "\" width=\"100px\" height=\"100px\"></td>" +
        "<td id=\"c_title\">"+val.title +"</td>" +
        "<td id=\"c_shortdesc\" ><div id=\"table_entries\">" + val.short_desc + "</div></td>" +
        "<td>"+val.category +"</td>" +
        "<td>"+val.start_date +"</td>" +
        "<td>"+val.course_length +"</td>" +
        "<td>"+val.site +"</td></tr>"
        ;
      });
      $("#coursetable").append(content);
    }
    //
    //TODO:
    //  add the search button handler
    //  add regex get requests
    //  add db queries on regex + course or prof option
    //


    //
    // locking header fucntionality
    //
    var div=$('#lockedHeader');
    var start=$(div).offset().top;

    $.event.add(window,'scroll',function(){
      var p=$(window).scrollTop();
      $(div).css('position',(p>start)?'fixed':'static');
      $(div).css('top',(p>start)?'0px':'');
      $(div).css('width',(p>start)?'inherit':'');
      //$(div).css('margin-left',(p>start)?'100px':'');
    });
  });

  </script>


  <div id="wrapper">
    <!-- Sidebar -->
    <nav class="navbar navbar-inverse navbar-fixed-top" id="sidebar-wrapper" role="navigation">
      <ul class="nav sidebar-nav">

        <li></li>
        <li class="sidebar-brand">
          <a href="#">Hi, Moocer</a>
        </li><li></li><li></li><li></li>
        <li></li><li></li><li></li><li>
          <a href="#">TODO List</a>
        </li><li></li><li></li>
        <li><a href="#">Course History</a>
        </li><li></li><li></li><li></li><li>
          <a href="#">Browse Per Major</a>
        </li><li></li><li></li><li></li>
        <li></li><li></li><li>
          <a href="#">Log In</a></li>

        </ul>
      </nav>

      <!-- /#sidebar-wrapper -->

      <!-- Page Content -->
      <div id="page-content-wrapper">
        <button type="button" class="sidebar-btn" >
        </button>
        <div class="container">

          <!-- Logo "MOOCs" -->
          <div class="row">
            <h1 class="logo">
              M
              <span class="glyphicon glyphicon-eye-open"></span>
              <span class="glyphicon glyphicon-eye-open"></span>
              Cs
            </h1>
          </div>
          <!-- End of Logo -->


          <!-- Search Bar -->
          <div class="row">
            <div class="col-md-offset-6 searchBar">
              <div class="input-group">
                <input id="searchBarTextBox" type="text" class="form-control" placeholder="Search...">
                <span class="input-group-btn">
                  <button class="btn btn-default" type="submit" id="search-btn">
                    <span class="glyphicon glyphicon-search"></span>
                  </button>
                </span>
              </div>
            </div>
            <!-- Search Options -->
            <div class="row" >
              <form role="form" class="searchOpt">
                <label> Search By:</label>
                <label class="radio-inline">
                  <input type="radio" name="courseOpt">Course
                </label>
                <label class="radio-inline">
                  <input type="radio" name="instructorOpt">Instructor
                </label>
              </form>
            </div>
            <!-- End of Search Options -->
          </div>
          <!--End of Search Bar  -->
          <br><br>

          <table>
            <tr>
              <table id="lockedHeader" class="table table-condensed table-bordered">
                <tr>
                  <td><b>Image</b></td>
                  <td><b>Title</b></td>
                  <td><b>Description</b></td>
                  <td><b>Category</b></td>
                  <td><b>Start Date</b></td>
                  <td><b>Length</b></td>
                  <td><b>Site</b></td>
                </tr>
              </table>
            </tr>
            <tr>
              <table id="coursetable" class="searchResTable table table-hover table-bordered">
              </table>
            </tr>
          </table>

          <!-- <table class="searchResTable table table-hover table-bordered"  >
          <thead>
          <tr>
          <th>Image</th>
          <th>Title</th>
          <th>Description</th>
          <th>Category</th>
          <th>Start Date</th>
          <th>Length</th>
          <th>Site</th>
        </tr>
      </thead>
      <tbody id="coursetable">
    </tbody>
  </table> -->

</div>
</div>
</div>

</body>
</html>
